{"ast":null,"code":"import _objectSpread from\"/Users/muhammadfizantariq/Downloads/Knext_2/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import{getCurrentUser,isAuthenticated}from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";const AppContext=/*#__PURE__*/createContext();export const useApp=()=>{const context=useContext(AppContext);if(!context){throw new Error('useApp must be used within AppProvider');}return context;};export const AppProvider=_ref=>{let{children}=_ref;// Initialize coach profile ONLY from valid token - no localStorage fallback\nconst initializeProfile=()=>{if(isAuthenticated()){const user=getCurrentUser();if(user){return{name:user.fullName,email:user.email,team:user.teamName,division:user.division,offense:user.offensiveSystem,defense:user.defensiveSystem};}}// No fallback - must have valid token\nreturn null;};// Coach Profile State\nconst[coachProfile,setCoachProfile]=useState(initializeProfile);// Coaching IQ / Bias State\nconst[coachingBias,setCoachingBias]=useState(()=>{const saved=localStorage.getItem('coachingBias');return saved?JSON.parse(saved):null;});// Team State\nconst[teamState,setTeamState]=useState(()=>{const saved=localStorage.getItem('teamState');return saved?JSON.parse(saved):{roster:[],teamKPI:0,systemFit:0,confidenceAvg:0,scholarshipUsed:0,nilUtilized:0};});// Player Profiles\nconst[playerProfiles,setPlayerProfiles]=useState(()=>{const saved=localStorage.getItem('playerProfiles');return saved?JSON.parse(saved):[];});// Recruiting State\nconst[recruitingState,setRecruitingState]=useState(()=>{const saved=localStorage.getItem('recruitingState');return saved?JSON.parse(saved):{activeRecruits:[],priorityRecruits:[],committedCount:0};});// Coach K Assistant State\nconst[coachKState,setCoachKState]=useState({isOpen:false,isMinimized:false,messages:[],currentStage:'welcome'});// Cleanup stale data and sync profile with token on mount\nuseEffect(()=>{// Clear all data if no valid token exists\nif(!isAuthenticated()){localStorage.removeItem('coachProfile');localStorage.removeItem('authToken');setCoachProfile(null);return;}// Sync profile from valid token\nif(isAuthenticated()&&!coachProfile){const user=getCurrentUser();if(user){setCoachProfile({name:user.fullName,email:user.email,team:user.teamName,division:user.division,offense:user.offensiveSystem,defense:user.defensiveSystem});}else{// Token exists but user data is invalid - clear everything\nlocalStorage.removeItem('coachProfile');localStorage.removeItem('authToken');setCoachProfile(null);}}},[]);// Persist to localStorage only if authenticated\nuseEffect(()=>{if(coachProfile&&isAuthenticated()){localStorage.setItem('coachProfile',JSON.stringify(coachProfile));}else if(!isAuthenticated()){// Clear profile if not authenticated\nlocalStorage.removeItem('coachProfile');}},[coachProfile]);useEffect(()=>{if(coachingBias){localStorage.setItem('coachingBias',JSON.stringify(coachingBias));}},[coachingBias]);useEffect(()=>{localStorage.setItem('teamState',JSON.stringify(teamState));},[teamState]);useEffect(()=>{localStorage.setItem('playerProfiles',JSON.stringify(playerProfiles));},[playerProfiles]);useEffect(()=>{localStorage.setItem('recruitingState',JSON.stringify(recruitingState));},[recruitingState]);// Helper Functions\nconst addPlayerProfile=player=>{setPlayerProfiles(prev=>[...prev,_objectSpread(_objectSpread({},player),{},{id:Date.now().toString()})]);};const updatePlayerProfile=(id,updates)=>{setPlayerProfiles(prev=>prev.map(player=>player.id===id?_objectSpread(_objectSpread({},player),updates):player));};const addToRoster=player=>{setTeamState(prev=>_objectSpread(_objectSpread({},prev),{},{roster:[...prev.roster,player]}));};const updateCoachingBias=bias=>{setCoachingBias(bias);};const addCoachKMessage=message=>{setCoachKState(prev=>_objectSpread(_objectSpread({},prev),{},{messages:[...prev.messages,_objectSpread(_objectSpread({},message),{},{timestamp:Date.now()})]}));};const toggleCoachK=()=>{setCoachKState(prev=>_objectSpread(_objectSpread({},prev),{},{isOpen:!prev.isOpen}));};const minimizeCoachK=()=>{setCoachKState(prev=>_objectSpread(_objectSpread({},prev),{},{isMinimized:true,isOpen:false}));};const value={coachProfile,setCoachProfile,coachingBias,setCoachingBias,updateCoachingBias,teamState,setTeamState,playerProfiles,setPlayerProfiles,addPlayerProfile,updatePlayerProfile,addToRoster,recruitingState,setRecruitingState,coachKState,setCoachKState,addCoachKMessage,toggleCoachK,minimizeCoachK};return/*#__PURE__*/_jsx(AppContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","getCurrentUser","isAuthenticated","jsx","_jsx","AppContext","useApp","context","Error","AppProvider","_ref","children","initializeProfile","user","name","fullName","email","team","teamName","division","offense","offensiveSystem","defense","defensiveSystem","coachProfile","setCoachProfile","coachingBias","setCoachingBias","saved","localStorage","getItem","JSON","parse","teamState","setTeamState","roster","teamKPI","systemFit","confidenceAvg","scholarshipUsed","nilUtilized","playerProfiles","setPlayerProfiles","recruitingState","setRecruitingState","activeRecruits","priorityRecruits","committedCount","coachKState","setCoachKState","isOpen","isMinimized","messages","currentStage","removeItem","setItem","stringify","addPlayerProfile","player","prev","_objectSpread","id","Date","now","toString","updatePlayerProfile","updates","map","addToRoster","updateCoachingBias","bias","addCoachKMessage","message","timestamp","toggleCoachK","minimizeCoachK","value","Provider"],"sources":["/Users/muhammadfizantariq/Downloads/Knext_2/frontend/src/context/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { getCurrentUser, isAuthenticated } from '../services/authService';\n\nconst AppContext = createContext();\n\nexport const useApp = () => {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within AppProvider');\n  }\n  return context;\n};\n\nexport const AppProvider = ({ children }) => {\n  // Initialize coach profile ONLY from valid token - no localStorage fallback\n  const initializeProfile = () => {\n    if (isAuthenticated()) {\n      const user = getCurrentUser();\n      if (user) {\n        return {\n          name: user.fullName,\n          email: user.email,\n          team: user.teamName,\n          division: user.division,\n          offense: user.offensiveSystem,\n          defense: user.defensiveSystem\n        };\n      }\n    }\n    // No fallback - must have valid token\n    return null;\n  };\n\n  // Coach Profile State\n  const [coachProfile, setCoachProfile] = useState(initializeProfile);\n\n  // Coaching IQ / Bias State\n  const [coachingBias, setCoachingBias] = useState(() => {\n    const saved = localStorage.getItem('coachingBias');\n    return saved ? JSON.parse(saved) : null;\n  });\n\n  // Team State\n  const [teamState, setTeamState] = useState(() => {\n    const saved = localStorage.getItem('teamState');\n    return saved ? JSON.parse(saved) : {\n      roster: [],\n      teamKPI: 0,\n      systemFit: 0,\n      confidenceAvg: 0,\n      scholarshipUsed: 0,\n      nilUtilized: 0\n    };\n  });\n\n  // Player Profiles\n  const [playerProfiles, setPlayerProfiles] = useState(() => {\n    const saved = localStorage.getItem('playerProfiles');\n    return saved ? JSON.parse(saved) : [];\n  });\n\n  // Recruiting State\n  const [recruitingState, setRecruitingState] = useState(() => {\n    const saved = localStorage.getItem('recruitingState');\n    return saved ? JSON.parse(saved) : {\n      activeRecruits: [],\n      priorityRecruits: [],\n      committedCount: 0\n    };\n  });\n\n  // Coach K Assistant State\n  const [coachKState, setCoachKState] = useState({\n    isOpen: false,\n    isMinimized: false,\n    messages: [],\n    currentStage: 'welcome'\n  });\n\n  // Cleanup stale data and sync profile with token on mount\n  useEffect(() => {\n    // Clear all data if no valid token exists\n    if (!isAuthenticated()) {\n      localStorage.removeItem('coachProfile');\n      localStorage.removeItem('authToken');\n      setCoachProfile(null);\n      return;\n    }\n\n    // Sync profile from valid token\n    if (isAuthenticated() && !coachProfile) {\n      const user = getCurrentUser();\n      if (user) {\n        setCoachProfile({\n          name: user.fullName,\n          email: user.email,\n          team: user.teamName,\n          division: user.division,\n          offense: user.offensiveSystem,\n          defense: user.defensiveSystem\n        });\n      } else {\n        // Token exists but user data is invalid - clear everything\n        localStorage.removeItem('coachProfile');\n        localStorage.removeItem('authToken');\n        setCoachProfile(null);\n      }\n    }\n  }, []);\n\n  // Persist to localStorage only if authenticated\n  useEffect(() => {\n    if (coachProfile && isAuthenticated()) {\n      localStorage.setItem('coachProfile', JSON.stringify(coachProfile));\n    } else if (!isAuthenticated()) {\n      // Clear profile if not authenticated\n      localStorage.removeItem('coachProfile');\n    }\n  }, [coachProfile]);\n\n  useEffect(() => {\n    if (coachingBias) {\n      localStorage.setItem('coachingBias', JSON.stringify(coachingBias));\n    }\n  }, [coachingBias]);\n\n  useEffect(() => {\n    localStorage.setItem('teamState', JSON.stringify(teamState));\n  }, [teamState]);\n\n  useEffect(() => {\n    localStorage.setItem('playerProfiles', JSON.stringify(playerProfiles));\n  }, [playerProfiles]);\n\n  useEffect(() => {\n    localStorage.setItem('recruitingState', JSON.stringify(recruitingState));\n  }, [recruitingState]);\n\n  // Helper Functions\n  const addPlayerProfile = (player) => {\n    setPlayerProfiles(prev => [...prev, { ...player, id: Date.now().toString() }]);\n  };\n\n  const updatePlayerProfile = (id, updates) => {\n    setPlayerProfiles(prev => \n      prev.map(player => player.id === id ? { ...player, ...updates } : player)\n    );\n  };\n\n  const addToRoster = (player) => {\n    setTeamState(prev => ({\n      ...prev,\n      roster: [...prev.roster, player]\n    }));\n  };\n\n  const updateCoachingBias = (bias) => {\n    setCoachingBias(bias);\n  };\n\n  const addCoachKMessage = (message) => {\n    setCoachKState(prev => ({\n      ...prev,\n      messages: [...prev.messages, { ...message, timestamp: Date.now() }]\n    }));\n  };\n\n  const toggleCoachK = () => {\n    setCoachKState(prev => ({ ...prev, isOpen: !prev.isOpen }));\n  };\n\n  const minimizeCoachK = () => {\n    setCoachKState(prev => ({ ...prev, isMinimized: true, isOpen: false }));\n  };\n\n  const value = {\n    coachProfile,\n    setCoachProfile,\n    coachingBias,\n    setCoachingBias,\n    updateCoachingBias,\n    teamState,\n    setTeamState,\n    playerProfiles,\n    setPlayerProfiles,\n    addPlayerProfile,\n    updatePlayerProfile,\n    addToRoster,\n    recruitingState,\n    setRecruitingState,\n    coachKState,\n    setCoachKState,\n    addCoachKMessage,\n    toggleCoachK,\n    minimizeCoachK\n  };\n\n  return <AppContext.Provider value={value}>{children}</AppContext.Provider>;\n};\n\n"],"mappings":"yIAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,OAASC,cAAc,CAAEC,eAAe,KAAQ,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE1E,KAAM,CAAAC,UAAU,cAAGR,aAAa,CAAC,CAAC,CAElC,MAAO,MAAM,CAAAS,MAAM,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,OAAO,CAAGT,UAAU,CAACO,UAAU,CAAC,CACtC,GAAI,CAACE,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAC,KAAK,CAAC,wCAAwC,CAAC,CAC3D,CACA,MAAO,CAAAD,OAAO,CAChB,CAAC,CAED,MAAO,MAAM,CAAAE,WAAW,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACtC;AACA,KAAM,CAAAE,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,GAAIV,eAAe,CAAC,CAAC,CAAE,CACrB,KAAM,CAAAW,IAAI,CAAGZ,cAAc,CAAC,CAAC,CAC7B,GAAIY,IAAI,CAAE,CACR,MAAO,CACLC,IAAI,CAAED,IAAI,CAACE,QAAQ,CACnBC,KAAK,CAAEH,IAAI,CAACG,KAAK,CACjBC,IAAI,CAAEJ,IAAI,CAACK,QAAQ,CACnBC,QAAQ,CAAEN,IAAI,CAACM,QAAQ,CACvBC,OAAO,CAAEP,IAAI,CAACQ,eAAe,CAC7BC,OAAO,CAAET,IAAI,CAACU,eAChB,CAAC,CACH,CACF,CACA;AACA,MAAO,KAAI,CACb,CAAC,CAED;AACA,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAG1B,QAAQ,CAACa,iBAAiB,CAAC,CAEnE;AACA,KAAM,CAACc,YAAY,CAAEC,eAAe,CAAC,CAAG5B,QAAQ,CAAC,IAAM,CACrD,KAAM,CAAA6B,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAClD,MAAO,CAAAF,KAAK,CAAGG,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC,CAAG,IAAI,CACzC,CAAC,CAAC,CAEF;AACA,KAAM,CAACK,SAAS,CAAEC,YAAY,CAAC,CAAGnC,QAAQ,CAAC,IAAM,CAC/C,KAAM,CAAA6B,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAC/C,MAAO,CAAAF,KAAK,CAAGG,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC,CAAG,CACjCO,MAAM,CAAE,EAAE,CACVC,OAAO,CAAE,CAAC,CACVC,SAAS,CAAE,CAAC,CACZC,aAAa,CAAE,CAAC,CAChBC,eAAe,CAAE,CAAC,CAClBC,WAAW,CAAE,CACf,CAAC,CACH,CAAC,CAAC,CAEF;AACA,KAAM,CAACC,cAAc,CAAEC,iBAAiB,CAAC,CAAG3C,QAAQ,CAAC,IAAM,CACzD,KAAM,CAAA6B,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC,CACpD,MAAO,CAAAF,KAAK,CAAGG,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC,CAAG,EAAE,CACvC,CAAC,CAAC,CAEF;AACA,KAAM,CAACe,eAAe,CAAEC,kBAAkB,CAAC,CAAG7C,QAAQ,CAAC,IAAM,CAC3D,KAAM,CAAA6B,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,CACrD,MAAO,CAAAF,KAAK,CAAGG,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC,CAAG,CACjCiB,cAAc,CAAE,EAAE,CAClBC,gBAAgB,CAAE,EAAE,CACpBC,cAAc,CAAE,CAClB,CAAC,CACH,CAAC,CAAC,CAEF;AACA,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGlD,QAAQ,CAAC,CAC7CmD,MAAM,CAAE,KAAK,CACbC,WAAW,CAAE,KAAK,CAClBC,QAAQ,CAAE,EAAE,CACZC,YAAY,CAAE,SAChB,CAAC,CAAC,CAEF;AACArD,SAAS,CAAC,IAAM,CACd;AACA,GAAI,CAACE,eAAe,CAAC,CAAC,CAAE,CACtB2B,YAAY,CAACyB,UAAU,CAAC,cAAc,CAAC,CACvCzB,YAAY,CAACyB,UAAU,CAAC,WAAW,CAAC,CACpC7B,eAAe,CAAC,IAAI,CAAC,CACrB,OACF,CAEA;AACA,GAAIvB,eAAe,CAAC,CAAC,EAAI,CAACsB,YAAY,CAAE,CACtC,KAAM,CAAAX,IAAI,CAAGZ,cAAc,CAAC,CAAC,CAC7B,GAAIY,IAAI,CAAE,CACRY,eAAe,CAAC,CACdX,IAAI,CAAED,IAAI,CAACE,QAAQ,CACnBC,KAAK,CAAEH,IAAI,CAACG,KAAK,CACjBC,IAAI,CAAEJ,IAAI,CAACK,QAAQ,CACnBC,QAAQ,CAAEN,IAAI,CAACM,QAAQ,CACvBC,OAAO,CAAEP,IAAI,CAACQ,eAAe,CAC7BC,OAAO,CAAET,IAAI,CAACU,eAChB,CAAC,CAAC,CACJ,CAAC,IAAM,CACL;AACAM,YAAY,CAACyB,UAAU,CAAC,cAAc,CAAC,CACvCzB,YAAY,CAACyB,UAAU,CAAC,WAAW,CAAC,CACpC7B,eAAe,CAAC,IAAI,CAAC,CACvB,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACAzB,SAAS,CAAC,IAAM,CACd,GAAIwB,YAAY,EAAItB,eAAe,CAAC,CAAC,CAAE,CACrC2B,YAAY,CAAC0B,OAAO,CAAC,cAAc,CAAExB,IAAI,CAACyB,SAAS,CAAChC,YAAY,CAAC,CAAC,CACpE,CAAC,IAAM,IAAI,CAACtB,eAAe,CAAC,CAAC,CAAE,CAC7B;AACA2B,YAAY,CAACyB,UAAU,CAAC,cAAc,CAAC,CACzC,CACF,CAAC,CAAE,CAAC9B,YAAY,CAAC,CAAC,CAElBxB,SAAS,CAAC,IAAM,CACd,GAAI0B,YAAY,CAAE,CAChBG,YAAY,CAAC0B,OAAO,CAAC,cAAc,CAAExB,IAAI,CAACyB,SAAS,CAAC9B,YAAY,CAAC,CAAC,CACpE,CACF,CAAC,CAAE,CAACA,YAAY,CAAC,CAAC,CAElB1B,SAAS,CAAC,IAAM,CACd6B,YAAY,CAAC0B,OAAO,CAAC,WAAW,CAAExB,IAAI,CAACyB,SAAS,CAACvB,SAAS,CAAC,CAAC,CAC9D,CAAC,CAAE,CAACA,SAAS,CAAC,CAAC,CAEfjC,SAAS,CAAC,IAAM,CACd6B,YAAY,CAAC0B,OAAO,CAAC,gBAAgB,CAAExB,IAAI,CAACyB,SAAS,CAACf,cAAc,CAAC,CAAC,CACxE,CAAC,CAAE,CAACA,cAAc,CAAC,CAAC,CAEpBzC,SAAS,CAAC,IAAM,CACd6B,YAAY,CAAC0B,OAAO,CAAC,iBAAiB,CAAExB,IAAI,CAACyB,SAAS,CAACb,eAAe,CAAC,CAAC,CAC1E,CAAC,CAAE,CAACA,eAAe,CAAC,CAAC,CAErB;AACA,KAAM,CAAAc,gBAAgB,CAAIC,MAAM,EAAK,CACnChB,iBAAiB,CAACiB,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAAC,aAAA,CAAAA,aAAA,IAAOF,MAAM,MAAEG,EAAE,CAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAChF,CAAC,CAED,KAAM,CAAAC,mBAAmB,CAAGA,CAACJ,EAAE,CAAEK,OAAO,GAAK,CAC3CxB,iBAAiB,CAACiB,IAAI,EACpBA,IAAI,CAACQ,GAAG,CAACT,MAAM,EAAIA,MAAM,CAACG,EAAE,GAAKA,EAAE,CAAAD,aAAA,CAAAA,aAAA,IAAQF,MAAM,EAAKQ,OAAO,EAAKR,MAAM,CAC1E,CAAC,CACH,CAAC,CAED,KAAM,CAAAU,WAAW,CAAIV,MAAM,EAAK,CAC9BxB,YAAY,CAACyB,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACZD,IAAI,MACPxB,MAAM,CAAE,CAAC,GAAGwB,IAAI,CAACxB,MAAM,CAAEuB,MAAM,CAAC,EAChC,CAAC,CACL,CAAC,CAED,KAAM,CAAAW,kBAAkB,CAAIC,IAAI,EAAK,CACnC3C,eAAe,CAAC2C,IAAI,CAAC,CACvB,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAIC,OAAO,EAAK,CACpCvB,cAAc,CAACU,IAAI,EAAAC,aAAA,CAAAA,aAAA,IACdD,IAAI,MACPP,QAAQ,CAAE,CAAC,GAAGO,IAAI,CAACP,QAAQ,CAAAQ,aAAA,CAAAA,aAAA,IAAOY,OAAO,MAAEC,SAAS,CAAEX,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,EACnE,CAAC,CACL,CAAC,CAED,KAAM,CAAAW,YAAY,CAAGA,CAAA,GAAM,CACzBzB,cAAc,CAACU,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAET,MAAM,CAAE,CAACS,IAAI,CAACT,MAAM,EAAG,CAAC,CAC7D,CAAC,CAED,KAAM,CAAAyB,cAAc,CAAGA,CAAA,GAAM,CAC3B1B,cAAc,CAACU,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAER,WAAW,CAAE,IAAI,CAAED,MAAM,CAAE,KAAK,EAAG,CAAC,CACzE,CAAC,CAED,KAAM,CAAA0B,KAAK,CAAG,CACZpD,YAAY,CACZC,eAAe,CACfC,YAAY,CACZC,eAAe,CACf0C,kBAAkB,CAClBpC,SAAS,CACTC,YAAY,CACZO,cAAc,CACdC,iBAAiB,CACjBe,gBAAgB,CAChBQ,mBAAmB,CACnBG,WAAW,CACXzB,eAAe,CACfC,kBAAkB,CAClBI,WAAW,CACXC,cAAc,CACdsB,gBAAgB,CAChBG,YAAY,CACZC,cACF,CAAC,CAED,mBAAOvE,IAAA,CAACC,UAAU,CAACwE,QAAQ,EAACD,KAAK,CAAEA,KAAM,CAAAjE,QAAA,CAAEA,QAAQ,CAAsB,CAAC,CAC5E,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}