{"ast":null,"code":"var _jsxFileName = \"/Users/muhammadfizantariq/Downloads/Knext_2/frontend/src/components/ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useApp } from '../context/AppContext';\nimport { isAuthenticated, getCurrentUser } from '../services/authService';\n\n/**\n * Protected Route Component\n * Redirects to login if user is not authenticated\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children\n}) => {\n  _s();\n  const {\n    coachProfile,\n    setCoachProfile\n  } = useApp();\n  const location = useLocation();\n  useEffect(() => {\n    // Check authentication and sync user profile\n    if (isAuthenticated()) {\n      const user = getCurrentUser();\n      if (user && !coachProfile) {\n        // Sync user data to context\n        setCoachProfile({\n          name: user.fullName,\n          email: user.email,\n          team: user.teamName,\n          division: user.division,\n          offense: user.offensiveSystem,\n          defense: user.defensiveSystem\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Strict authentication check - must have valid token\n  if (!isAuthenticated()) {\n    // Clear ALL stale data\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    // Redirect to login with return URL\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Double-check: verify token is valid and user exists\n  const user = getCurrentUser();\n  if (!user) {\n    // Token exists but is invalid - clear everything\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 12\n    }, this);\n  }\n  return children;\n};\n_s(ProtectedRoute, \"dhZ84+JWP7gA4bxG1gSwAyXsClw=\", false, function () {\n  return [useApp, useLocation];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","Navigate","useLocation","useApp","isAuthenticated","getCurrentUser","jsxDEV","_jsxDEV","ProtectedRoute","children","_s","coachProfile","setCoachProfile","location","user","name","fullName","email","team","teamName","division","offense","offensiveSystem","defense","defensiveSystem","localStorage","removeItem","to","state","from","replace","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/muhammadfizantariq/Downloads/Knext_2/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useApp } from '../context/AppContext';\nimport { isAuthenticated, getCurrentUser } from '../services/authService';\n\n/**\n * Protected Route Component\n * Redirects to login if user is not authenticated\n */\nconst ProtectedRoute = ({ children }) => {\n  const { coachProfile, setCoachProfile } = useApp();\n  const location = useLocation();\n\n  useEffect(() => {\n    // Check authentication and sync user profile\n    if (isAuthenticated()) {\n      const user = getCurrentUser();\n      if (user && !coachProfile) {\n        // Sync user data to context\n        setCoachProfile({\n          name: user.fullName,\n          email: user.email,\n          team: user.teamName,\n          division: user.division,\n          offense: user.offensiveSystem,\n          defense: user.defensiveSystem\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Strict authentication check - must have valid token\n  if (!isAuthenticated()) {\n    // Clear ALL stale data\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    // Redirect to login with return URL\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // Double-check: verify token is valid and user exists\n  const user = getCurrentUser();\n  if (!user) {\n    // Token exists but is invalid - clear everything\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  return children;\n};\n\nexport default ProtectedRoute;\n\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,SAASC,MAAM,QAAQ,uBAAuB;AAC9C,SAASC,eAAe,EAAEC,cAAc,QAAQ,yBAAyB;;AAEzE;AACA;AACA;AACA;AAHA,SAAAC,MAAA,IAAAC,OAAA;AAIA,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACvC,MAAM;IAAEC,YAAY;IAAEC;EAAgB,CAAC,GAAGT,MAAM,CAAC,CAAC;EAClD,MAAMU,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAE9BF,SAAS,CAAC,MAAM;IACd;IACA,IAAII,eAAe,CAAC,CAAC,EAAE;MACrB,MAAMU,IAAI,GAAGT,cAAc,CAAC,CAAC;MAC7B,IAAIS,IAAI,IAAI,CAACH,YAAY,EAAE;QACzB;QACAC,eAAe,CAAC;UACdG,IAAI,EAAED,IAAI,CAACE,QAAQ;UACnBC,KAAK,EAAEH,IAAI,CAACG,KAAK;UACjBC,IAAI,EAAEJ,IAAI,CAACK,QAAQ;UACnBC,QAAQ,EAAEN,IAAI,CAACM,QAAQ;UACvBC,OAAO,EAAEP,IAAI,CAACQ,eAAe;UAC7BC,OAAO,EAAET,IAAI,CAACU;QAChB,CAAC,CAAC;MACJ;IACF;IACA;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,IAAI,CAACpB,eAAe,CAAC,CAAC,EAAE;IACtB;IACAqB,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;IACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;IACpCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;IACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;IACpCD,YAAY,CAACC,UAAU,CAAC,gBAAgB,CAAC;IACzCD,YAAY,CAACC,UAAU,CAAC,iBAAiB,CAAC;IAC1C;IACA,oBAAOnB,OAAA,CAACN,QAAQ;MAAC0B,EAAE,EAAC,QAAQ;MAACC,KAAK,EAAE;QAAEC,IAAI,EAAEhB;MAAS,CAAE;MAACiB,OAAO;IAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE;;EAEA;EACA,MAAMpB,IAAI,GAAGT,cAAc,CAAC,CAAC;EAC7B,IAAI,CAACS,IAAI,EAAE;IACT;IACAW,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;IACpCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;IACvCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;IACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;IACpCD,YAAY,CAACC,UAAU,CAAC,gBAAgB,CAAC;IACzCD,YAAY,CAACC,UAAU,CAAC,iBAAiB,CAAC;IAC1C,oBAAOnB,OAAA,CAACN,QAAQ;MAAC0B,EAAE,EAAC,QAAQ;MAACC,KAAK,EAAE;QAAEC,IAAI,EAAEhB;MAAS,CAAE;MAACiB,OAAO;IAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE;EAEA,OAAOzB,QAAQ;AACjB,CAAC;AAACC,EAAA,CAlDIF,cAAc;EAAA,QACwBL,MAAM,EAC/BD,WAAW;AAAA;AAAAiC,EAAA,GAFxB3B,cAAc;AAoDpB,eAAeA,cAAc;AAAC,IAAA2B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}