{"ast":null,"code":"import React,{useEffect}from'react';import{Navigate,useLocation}from'react-router-dom';import{useApp}from'../context/AppContext';import{isAuthenticated,getCurrentUser}from'../services/authService';/**\n * Protected Route Component\n * Redirects to login if user is not authenticated\n */import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children}=_ref;const{coachProfile,setCoachProfile}=useApp();const location=useLocation();useEffect(()=>{// Check authentication and sync user profile\nif(isAuthenticated()){const user=getCurrentUser();if(user&&!coachProfile){// Sync user data to context\nsetCoachProfile({name:user.fullName,email:user.email,team:user.teamName,division:user.division,offense:user.offensiveSystem,defense:user.defensiveSystem});}}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Strict authentication check - must have valid token\nif(!isAuthenticated()){// Clear ALL stale data\nlocalStorage.removeItem('coachProfile');localStorage.removeItem('authToken');localStorage.removeItem('coachingBias');localStorage.removeItem('teamState');localStorage.removeItem('playerProfiles');localStorage.removeItem('recruitingState');// Redirect to login with return URL\nreturn/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}// Double-check: verify token is valid and user exists\nconst user=getCurrentUser();if(!user){// Token exists but is invalid - clear everything\nlocalStorage.removeItem('authToken');localStorage.removeItem('coachProfile');localStorage.removeItem('coachingBias');localStorage.removeItem('teamState');localStorage.removeItem('playerProfiles');localStorage.removeItem('recruitingState');return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}return children;};export default ProtectedRoute;","map":{"version":3,"names":["React","useEffect","Navigate","useLocation","useApp","isAuthenticated","getCurrentUser","jsx","_jsx","ProtectedRoute","_ref","children","coachProfile","setCoachProfile","location","user","name","fullName","email","team","teamName","division","offense","offensiveSystem","defense","defensiveSystem","localStorage","removeItem","to","state","from","replace"],"sources":["/Users/muhammadfizantariq/Downloads/Knext_2/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useApp } from '../context/AppContext';\nimport { isAuthenticated, getCurrentUser } from '../services/authService';\n\n/**\n * Protected Route Component\n * Redirects to login if user is not authenticated\n */\nconst ProtectedRoute = ({ children }) => {\n  const { coachProfile, setCoachProfile } = useApp();\n  const location = useLocation();\n\n  useEffect(() => {\n    // Check authentication and sync user profile\n    if (isAuthenticated()) {\n      const user = getCurrentUser();\n      if (user && !coachProfile) {\n        // Sync user data to context\n        setCoachProfile({\n          name: user.fullName,\n          email: user.email,\n          team: user.teamName,\n          division: user.division,\n          offense: user.offensiveSystem,\n          defense: user.defensiveSystem\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Strict authentication check - must have valid token\n  if (!isAuthenticated()) {\n    // Clear ALL stale data\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    // Redirect to login with return URL\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // Double-check: verify token is valid and user exists\n  const user = getCurrentUser();\n  if (!user) {\n    // Token exists but is invalid - clear everything\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('coachProfile');\n    localStorage.removeItem('coachingBias');\n    localStorage.removeItem('teamState');\n    localStorage.removeItem('playerProfiles');\n    localStorage.removeItem('recruitingState');\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  return children;\n};\n\nexport default ProtectedRoute;\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,MAAM,KAAQ,uBAAuB,CAC9C,OAASC,eAAe,CAAEC,cAAc,KAAQ,yBAAyB,CAEzE;AACA;AACA;AACA,GAHA,OAAAC,GAAA,IAAAC,IAAA,yBAIA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAClC,KAAM,CAAEE,YAAY,CAAEC,eAAgB,CAAC,CAAGT,MAAM,CAAC,CAAC,CAClD,KAAM,CAAAU,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd;AACA,GAAII,eAAe,CAAC,CAAC,CAAE,CACrB,KAAM,CAAAU,IAAI,CAAGT,cAAc,CAAC,CAAC,CAC7B,GAAIS,IAAI,EAAI,CAACH,YAAY,CAAE,CACzB;AACAC,eAAe,CAAC,CACdG,IAAI,CAAED,IAAI,CAACE,QAAQ,CACnBC,KAAK,CAAEH,IAAI,CAACG,KAAK,CACjBC,IAAI,CAAEJ,IAAI,CAACK,QAAQ,CACnBC,QAAQ,CAAEN,IAAI,CAACM,QAAQ,CACvBC,OAAO,CAAEP,IAAI,CAACQ,eAAe,CAC7BC,OAAO,CAAET,IAAI,CAACU,eAChB,CAAC,CAAC,CACJ,CACF,CACA;AACF,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,GAAI,CAACpB,eAAe,CAAC,CAAC,CAAE,CACtB;AACAqB,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC,CACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CACpCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC,CACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CACpCD,YAAY,CAACC,UAAU,CAAC,gBAAgB,CAAC,CACzCD,YAAY,CAACC,UAAU,CAAC,iBAAiB,CAAC,CAC1C;AACA,mBAAOnB,IAAA,CAACN,QAAQ,EAAC0B,EAAE,CAAC,QAAQ,CAACC,KAAK,CAAE,CAAEC,IAAI,CAAEhB,QAAS,CAAE,CAACiB,OAAO,MAAE,CAAC,CACpE,CAEA;AACA,KAAM,CAAAhB,IAAI,CAAGT,cAAc,CAAC,CAAC,CAC7B,GAAI,CAACS,IAAI,CAAE,CACT;AACAW,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CACpCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC,CACvCD,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC,CACvCD,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CACpCD,YAAY,CAACC,UAAU,CAAC,gBAAgB,CAAC,CACzCD,YAAY,CAACC,UAAU,CAAC,iBAAiB,CAAC,CAC1C,mBAAOnB,IAAA,CAACN,QAAQ,EAAC0B,EAAE,CAAC,QAAQ,CAACC,KAAK,CAAE,CAAEC,IAAI,CAAEhB,QAAS,CAAE,CAACiB,OAAO,MAAE,CAAC,CACpE,CAEA,MAAO,CAAApB,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}